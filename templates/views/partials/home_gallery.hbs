<div id="imageButton" style="background-image:url('{{photos.0.url}}')" />
<div class="progress-bar">
    <span class="progress-bar-fill"></span>
</div>

<script type="text/javascript">
  var images = JSON.parse('{{{json photos}}}'),
      i = 0,
      img = document.getElementById('imageButton'),
      // holds the setInterval when hovering content
      interval;

  // for (var j=images.length; j--;) {
  //     var img = new Image();
  //     img.src = images[j].url;
  // }
//   function move() {
//     var elem = document.getElementById("myBar");
//     var width = 1;
//     var id = setInterval(frame, 5000);
//     function frame() {
//         if (width >= 100) {
//             clearInterval(id);
//         } else {
//             width++;
//             elem.style.width = width + '%';
//         }
//     }
//   }
//
// move()
  document.addEventListener('keydown', function(e) {
    var imageUrl = null;

    //  arrow-back or arrow-next
    if (e.keyCode===37) {
      if (i===0){
        i=images.length-1;
        imageurl = images[i].url;
      } else {
        imageurl = images[--i].url;
      }

      document.getElementById('imageButton').style = "background-image:url("+imageurl+")";

    } else if (e.keyCode===39){
      imageurl = images[i >= images.length - 1 ? i = 0 : ++i].url;
      document.getElementById('imageButton').style = "background-image:url("+imageurl+")"

    }
  }, false);

  img.addEventListener('click', function() {
    var imageurl = images[i >= images.length - 1 ? i = 0 : ++i].url;
    this.style="background-image:url("+imageurl+")";console.log(i)
  }, false);

  img.addEventListener('mouseover', function() {

    var progessBarWidth = $('.progress-bar-fill').css('width');
    $('.progress-bar-fill').css('width',
    progessBarWidth === "560px" ? '0%' : '100%')

    // progress = setInterval(function(){
    //   var imageurl = images[i >= images.length - 1 ? i = 0 : ++i].url;
    //   this.style="background-image:url("+imageurl+")";
    // }.bind(this), 5000);
    var image = this;
    interval = setInterval(function(){
      const width = $('.progress-bar-fill').css('width');
      var imageurl = images[i >= images.length - 1 ? i = 0 : ++i].url;
      image.style="background-image:url("+imageurl+")";
      console.log(width)
      $('.progress-bar-fill').css('width', width === "560px" ? '0%' : '100%' )
    }, 5000);
  }, false);

  img.addEventListener('mouseout', function() {
    clearInterval(interval);
    $('.progress-bar-fill').css('width', '0%')
  }, false);

</script>
